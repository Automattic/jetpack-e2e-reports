(this["webpackJsonpjetpack-e2e-reports"]=this["webpackJsonpjetpack-e2e-reports"]||[]).push([[0],{160:function(t){t.exports=JSON.parse('{"permanent":["master","atomic","gutenberg"],"ignore":["static","e2e"]}')},190:function(t,e,a){},194:function(t,e,a){},332:function(t,e,a){"use strict";a.r(e);var s=a(0),r=a.n(s),n=a(43),i=a.n(n),c=(a(190),a(20)),o=a(33),l=(a(193),a(194),a(343)),u=a(342),j=a(344),d=a(21),p=a(29),h=a(30),b=a(31),f=a(34),O=a(160),m=a(334),v=a(335),x=a(336),k=a(119),y=a(75),g=a(2),C=function(t){Object(b.a)(a,t);var e=Object(f.a)(a);function a(){var t;Object(p.a)(this,a);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))).state={reports:t.props.reports,sort:{by:"lastUpdate",isAsc:!1}},t}return Object(h.a)(a,[{key:"componentDidMount",value:function(){this.sortTable(this.state.sort.by,this.state.sort.isAsc)}},{key:"sortTable",value:function(t,e){switch(this.setState({sort:{by:t,isAsc:e}}),t){case"name":return this.sortByName(e);case"lastUpdate":return this.sortByDate(e);case"statistic":return this.sortByStatus(e)}}},{key:"sortByDate",value:function(t){return this.state.reports.sort((function(e,a){return t?Date.parse(e.lastUpdate)-Date.parse(a.lastUpdate):Date.parse(a.lastUpdate)-Date.parse(e.lastUpdate)}))}},{key:"sortByName",value:function(t){return this.state.reports.sort((function(e,a){return t?e.name-a.name:a.name-e.name}))}},{key:"sortByStatus",value:function(t){return this.state.reports.sort((function(e,a){return t?e.statistic.failed+e.statistic.broken-(a.statistic.failed+a.statistic.broken):a.statistic.failed+a.statistic.broken-(e.statistic.failed+e.statistic.broken)}))}},{key:"getTableHeader",value:function(){var t,e,a=this,s={name:"report id",statistic:"no of failures",lastUpdate:"most recent"},r=this.state.sort.isAsc?"sort-by-asc":"sort-by-desc";return this.props.options.sortButtons&&(t=Object.keys(s).map((function(t,e){return Object(g.jsxs)(m.a,{variant:"dark",onClick:function(){a.sortTable(t,!a.state.sort.isAsc)},children:[s[t].toUpperCase(),Object(g.jsx)("span",{className:a.state.sort.by===t?r:""})]},e)}))),this.props.reportCount&&(e="".concat(this.state.reports.length," reports")),Object(g.jsx)("thead",{children:Object(g.jsx)("tr",{className:"headerRow",children:Object(g.jsx)("td",{colSpan:"3",className:"sortButtons",children:Object(g.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(g.jsx)("div",{children:e}),Object(g.jsx)("div",{children:t})]})})})})}},{key:"getReportRow",value:function(t,e){var a=t.statistic,s=t.metadata,r=a.total!==a.passed+a.skipped;return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{className:"reportNameCell",children:this.getReportLinkCell(t,s,r,a.total)}),Object(g.jsx)("td",{children:this.getTestResultsCell(a)}),Object(g.jsx)("td",{children:this.getMetadataCell(t)})]},e)}},{key:"getReportLinkCell",value:function(t,e,a,s){var r="https://automattic.github.io/jetpack-e2e-reports/".concat(t.name,"/report/"),n=t.name,i=t.name;if(e.pr_title){var c="(#".concat(e.pr_number,")");i="".concat(e.pr_title," ").concat(c)}var l="https://github.com/Automattic/jetpack/tree/".concat(e.branch),u="https://github.com/Automattic/jetpack/pull/".concat(e.pr_number),j=y.c,d="warning";return s>0&&(j=a?y.d:y.a,d=a?"failed":"passed"),Object(g.jsxs)("ul",{className:"list-unstyled",children:[Object(g.jsxs)("li",{children:[Object(g.jsx)(k.a,{className:d,icon:j}),"\xa0",Object(g.jsxs)("a",{href:r,className:"report-link",target:"_blank",rel:"noreferrer",onClick:function(){return o.a.pageview("/"+t.name)},children:[i,Object(g.jsx)("br",{})]})]}),Object(g.jsx)("li",{children:Object(g.jsxs)("small",{children:["#",n," "," \u2022 ",Object(g.jsx)(k.a,{icon:y.b})," ",Object(g.jsx)("a",{href:l,target:"_blank",className:"report-link",rel:"noreferrer",children:e.branch}),e.pr_number?" \u2022 ":"",e.pr_number&&Object(g.jsxs)("a",{href:u,target:"_blank",className:"report-link",rel:"noreferrer",children:["PR ",e.pr_number]})]})})]})}},{key:"getTestResultsCell",value:function(t){var e=["failed","passed","total"].map((function(e,a){var s="failed"===e?t[e]+t.broken:t[e];return Object(g.jsxs)(v.a,{className:"label label-status-".concat(e),children:[e," ",s]},a)}));return Object(g.jsx)("div",{children:e})}},{key:"getMetadataCell",value:function(t){var e="https://github.com/Automattic/jetpack/actions/runs/".concat(t.metadata.run_id);return Object(g.jsxs)("ul",{className:"list-unstyled",children:[Object(g.jsx)("li",{children:Object(g.jsxs)("small",{children:["last update:"," ",new Date(Date.parse(t.lastUpdate)).toLocaleString()]})}),Object(g.jsx)("li",{children:Object(g.jsxs)("small",{children:["last run id:"," ",Object(g.jsx)("a",{href:e,target:"_blank",className:"report-link",rel:"noreferrer",children:t.metadata.run_id})]})})]})}},{key:"render",value:function(){var t=this;return Object(g.jsxs)(x.a,{hover:!0,responsive:"sm",size:"sm",variant:"dark",className:"reportsTable",children:[this.getTableHeader(),Object(g.jsx)("tbody",{children:this.state.reports.map((function(e,a){return t.getReportRow(e,a)}))}),Object(g.jsx)("tfoot",{children:Object(g.jsx)("tr",{children:Object(g.jsx)("td",{colSpan:3})})})]})}}]),a}(r.a.Component),S=function(t){Object(b.a)(a,t);var e=Object(f.a)(a);function a(t){var s;return Object(p.a)(this,a),(s=e.call(this,t)).state={reports:[],pinnedReports:[],docsSize:void 0,reportsCount:void 0,isDataFetched:!1},s}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var t=this;fetch("./summary.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){var a,s={reports:[]},r={reports:[]},n=Object(d.a)(e.reports);try{for(n.s();!(a=n.n()).done;){var i=a.value;O.permanent.includes(i.name)?r.reports.push(i):s.reports.push(i)}}catch(c){n.e(c)}finally{n.f()}t.setState({reports:s.reports,pinnedReports:r.reports,docsSize:e.docsSize,reportsCount:e.reportsCount,isDataFetched:!0})})).catch(console.log),o.a.pageview("/reports")}},{key:"render",value:function(){return this.state.isDataFetched?Object(g.jsxs)("div",{children:[Object(g.jsxs)("div",{className:"reports-header",children:[this.state.reportsCount," reports"]}),Object(g.jsx)(C,{reports:this.state.pinnedReports,options:{reportCount:!1,sortButtons:!1}}),Object(g.jsx)(C,{reports:this.state.reports,options:{reportCount:!1,sortButtons:!0}}),Object(g.jsxs)("small",{className:"footnote",children:["docs size: ",this.state.docsSize]})]}):null}}]),a}(r.a.Component),A=a(337),N=a(341),w=a(174),T=a(175),D=a(78),R=a(73),_=a(179),M=function(t){Object(b.a)(a,t);var e=Object(f.a)(a);function a(t){var s;return Object(p.a)(this,a),(s=e.call(this,t)).state={data:{reports:[]},stats:[],failedTests:[],statsChartData:[]},s}return Object(h.a)(a,[{key:"parseStats",value:function(){var t={};this.state.stats.forEach((function(e){var a=new Date(e.time.start).toISOString().split("T")[0];t[a]?(t[a].failed+=e.statistic.failed+e.statistic.broken,t[a].skipped+=e.statistic.skipped,t[a].passed+=e.statistic.passed,t[a].unknown+=e.statistic.unknown,t[a].total+=e.statistic.total):(t[a]=Object.assign({},e.statistic),t[a].failed+=e.statistic.broken,t[a].date=a)})),this.setState({statsChartData:Object.values(t)})}},{key:"componentDidMount",value:function(){var t=this;fetch("./metrics.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){t.setState({stats:e.stats}),t.setState({failedTests:e.failedTests}),t.parseStats()})).catch(console.log),o.a.pageview("#metrics")}},{key:"renderStatsSummary",value:function(){var t=this.state.stats.reduce((function(t,e){return t.failed+=e.statistic.failed+e.statistic.broken,t.testCases+=e.statistic.total,t.total++,t}),{failed:0,testCases:0,total:0});console.log(JSON.stringify(t));var e=t.failed/t.testCases*100;return Object(g.jsx)("div",{children:Object(g.jsxs)("p",{children:["Failures: ",e,"% Test case runs:"," ",t.testCases," Total runs: ",t.total]})})}},{key:"renderFailedTests",value:function(){return this.state.failedTests.map((function(t,e){return Object(g.jsxs)("div",{children:[t.fileName," ",t.name," ",t.error.statusMessage," ",t.error.statusTrace.substring(20)]},e)}))}},{key:"renderSummaryChart",value:function(){return Object(g.jsx)("div",{children:Object(g.jsxs)(A.a,{width:1200,height:300,data:this.state.statsChartData,margin:{top:5,right:60,bottom:5,left:60},children:[Object(g.jsx)(N.a,{stroke:"white"}),Object(g.jsx)(w.a,{dataKey:"date",stroke:"white"}),Object(g.jsx)(T.a,{stroke:"white"}),Object(g.jsx)(D.a,{}),Object(g.jsx)(R.a,{}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"passed",stroke:"#8884d8",isAnimationActive:!1}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"failed",stroke:"#82ca9d",isAnimationActive:!1})]})})}},{key:"render",value:function(){return Object(g.jsxs)("div",{children:[this.renderStatsSummary(),this.renderSummaryChart()]})}}]),a}(r.a.Component),B=function(t){Object(b.a)(a,t);var e=Object(f.a)(a);function a(t){var s;return Object(p.a)(this,a),(s=e.call(this,t)).state={rawData:[]},s}return Object(h.a)(a,[{key:"prepareChartData",value:function(){var t={},e={};this.state.rawData.forEach((function(t){var a=new Date(t.date);a=a.toISOString().split("T")[0],e[a]||(e[a]=[]);var s=Object.keys(t.baseAvg).reduce((function(e,a){var s;return e[a]=(s=t.baseAvg[a],100*(t.jetpackAvg[a]/s-1)),e}),{});e[a].push(s)})),Object.entries(e).forEach((function(e){var a=Object(c.a)(e,2),s=a[0],r=a[1],n=r.length;t[s]={date:s},Object.keys(r[0]).forEach((function(e){t[s][e]=r.reduce((function(t,a){return t+a[e]}),0),t[s][e]/=n,t[s][e]=Math.round(100*t[s][e])/100}))})),console.log(JSON.stringify(t)),this.setState({chartData:Object.values(t)})}},{key:"componentDidMount",value:function(){var t=this;fetch("./perf-metrics.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){t.setState({rawData:e}),t.prepareChartData()})).catch(console.log),o.a.pageview("#metrics")}},{key:"renderStatsSummary",value:function(){var t=this.state.stats.reduce((function(t,e){return t.failed+=e.statistic.failed+e.statistic.broken,t.testCases+=e.statistic.total,t.total++,t}),{failed:0,testCases:0,total:0});console.log(JSON.stringify(t));var e=t.failed/t.testCases*100;return Object(g.jsx)("div",{children:Object(g.jsxs)("p",{children:["Failures: ",e,"% Test case runs:"," ",t.testCases," Total runs: ",t.total]})})}},{key:"renderFailedTests",value:function(){return this.state.failedTests.map((function(t,e){return Object(g.jsxs)("div",{children:[t.fileName," ",t.name," ",t.error.statusMessage," ",t.error.statusTrace.substring(20)]},e)}))}},{key:"renderChart",value:function(){return Object(g.jsx)("div",{children:Object(g.jsxs)(A.a,{width:1200,height:300,data:this.state.chartData,margin:{top:5,right:60,bottom:5,left:60},children:[Object(g.jsx)(N.a,{stroke:"white"}),Object(g.jsx)(w.a,{dataKey:"date",stroke:"white"}),Object(g.jsx)(T.a,{stroke:"white"}),Object(g.jsx)(D.a,{}),Object(g.jsx)(R.a,{}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"loaded",stroke:"blue",isAnimationActive:!1}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"firstContentfulPaint",stroke:"green",isAnimationActive:!1}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"type",stroke:"red",isAnimationActive:!1}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"focus",stroke:"grey",isAnimationActive:!1}),Object(g.jsx)(_.a,{type:"monotone",dataKey:"inserterOpen",stroke:"magenta",isAnimationActive:!1})]})})}},{key:"render",value:function(){return Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"PERF METRICS"}),this.renderChart()]})}}]),a}(r.a.Component),K=function(t){Object(b.a)(a,t);var e=Object(f.a)(a);function a(){return Object(p.a)(this,a),e.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"METRICS"}),Object(g.jsx)(M,{}),Object(g.jsx)(B,{})]})}}]),a}(r.a.Component);o.a.initialize("UA-208890082-1");var U=function(t,e){t(e),location.hash=e};function E(t){var e=t.activeNavbar,a=t.setActiveNavbar;return Object(g.jsx)(l.a,{variant:"dark",expand:"md",className:"app-nav-bar",children:Object(g.jsxs)(u.a,{fluid:!0,className:"app-nav-bar-inner-container",children:[Object(g.jsx)(l.a.Brand,{href:"#",children:"Jetpack test results dashboard"}),Object(g.jsx)(l.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(g.jsx)(l.a.Collapse,{id:"basic-navbar-nav",children:Object(g.jsxs)(j.a,{activeKey:e,className:"ml-auto",children:[Object(g.jsx)(j.a.Link,{href:"#reports",onSelect:function(t){return U(a,t)},children:"Recent reports"}),Object(g.jsx)(j.a.Link,{href:"#metrics",onSelect:function(t){return U(a,t)},children:"Metrics"})]})})]})})}var F=function(){var t=Object(s.useState)("#reports"),e=Object(c.a)(t,2),a=e[0],r=e[1];return location.hash&&["#reports","#metrics"].includes(location.hash)&&a!==location.hash&&r(location.hash),Object(g.jsxs)(u.a,{fluid:!0,className:"App",children:[Object(g.jsxs)("div",{className:"App-content",children:[Object(g.jsx)(E,{activeNavbar:a,setActiveNavbar:r}),"#reports"===a?Object(g.jsx)(S,{}):Object(g.jsx)(K,{})]}),Object(g.jsx)("footer",{className:"App-footer",children:Object(g.jsxs)("div",{children:[Object(g.jsx)("a",{target:"_blank",href:"https://github.com/Automattic/jetpack-e2e-reports/",rel:"noreferrer",children:"Code"})," \u2022 ",Object(g.jsx)("a",{target:"_blank",href:"https://github.com/Automattic/jetpack-e2e-reports/actions",rel:"noreferrer",children:"Actions"})]})})]})};i.a.render(Object(g.jsx)(r.a.StrictMode,{children:Object(g.jsx)(F,{})}),document.getElementById("root"))}},[[332,1,2]]]);
//# sourceMappingURL=main.81ad67c1.chunk.js.map