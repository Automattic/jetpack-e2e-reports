(this["webpackJsonpjetpack-e2e-reports"]=this["webpackJsonpjetpack-e2e-reports"]||[]).push([[0],{188:function(t,e,a){},192:function(t,e,a){},330:function(t,e,a){"use strict";a.r(e);var s=a(0),r=a.n(s),n=a(38),c=a.n(n),i=(a(188),a(21)),o=a(49),l=(a(191),a(192),a(85)),d=a(86),j=a(87),u=a(93),b=a(333),h=a(334),p=a(335),f=a(119),v=a(71),O=a(3),m=function(t){Object(j.a)(a,t);var e=Object(u.a)(a);function a(t){var s;return Object(l.a)(this,a),(s=e.call(this,t)).updateSorting=function(t,e){return s.setState({sortBy:t,isSortAsc:e})},s.state={data:{reports:[]},sortBy:"lastUpdate",isSortAsc:!1},s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var t=this;fetch("./summary.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){t.setState({data:e})})).catch(console.log),o.a.pageview("reports")}},{key:"sortTable",value:function(t,e){switch(t){case"name":return this.sortAlphabetically(e);case"lastUpdate":return this.sortByDate(e);case"statistic":return this.sortByStatus(e)}}},{key:"sortByDate",value:function(t){return this.state.data.reports.sort((function(e,a){return t?Date.parse(e.lastUpdate)-Date.parse(a.lastUpdate):Date.parse(a.lastUpdate)-Date.parse(e.lastUpdate)}))}},{key:"sortAlphabetically",value:function(t){return this.state.data.reports.sort((function(e,a){return t?e.name-a.name:a.name-e.name}))}},{key:"sortByStatus",value:function(t){return this.state.data.reports.sort((function(e,a){return t?e.statistic.failed+e.statistic.broken-(a.statistic.failed+a.statistic.broken):a.statistic.failed+a.statistic.broken-(e.statistic.failed+e.statistic.broken)}))}},{key:"renderReportLink",value:function(t,e,a,s){var r="https://automattic.github.io/jetpack-e2e-reports/".concat(t.name,"/report/"),n=t.name,c=t.name;if(e.pr_title){var i;i="(#".concat(e.pr_number,")"),c="".concat(e.pr_title," ").concat(i)}var l="https://github.com/Automattic/jetpack/tree/".concat(e.branch),d="https://github.com/Automattic/jetpack/pull/".concat(e.pr_number),j=v.c,u="warning";return s>0&&(j=a?v.d:v.a,u=a?"failed":"passed"),Object(O.jsxs)("ul",{className:"list-unstyled",children:[Object(O.jsxs)("li",{children:[Object(O.jsx)(f.a,{className:u,icon:j}),"\xa0",Object(O.jsxs)("a",{href:r,className:"report-link",target:"_blank",rel:"noreferrer",onClick:function(){return o.a.pageview(t.name)},children:[c,Object(O.jsx)("br",{})]})]}),Object(O.jsx)("li",{children:Object(O.jsxs)("small",{children:["#",n," "," \u2022 ",Object(O.jsx)(f.a,{icon:v.b})," ",Object(O.jsx)("a",{href:l,target:"_blank",className:"report-link",rel:"noreferrer",children:e.branch}),e.pr_number?" \u2022 ":"",e.pr_number&&Object(O.jsxs)("a",{href:d,target:"_blank",className:"report-link",rel:"noreferrer",children:["PR ",e.pr_number]})]})})]})}},{key:"renderResults",value:function(t){var e=["failed","passed","total"].map((function(e,a){var s="failed"===e?t[e]+t.broken:t[e];return Object(O.jsxs)(b.a,{className:"label label-status-".concat(e),children:[e," ",s]},a)}));return Object(O.jsx)("div",{children:e})}},{key:"renderMetadataCell",value:function(t){var e="https://github.com/Automattic/jetpack/actions/runs/".concat(t.metadata.run_id);return Object(O.jsxs)("ul",{className:"list-unstyled",children:[Object(O.jsx)("li",{children:Object(O.jsxs)("small",{children:["last update:"," ",new Date(Date.parse(t.lastUpdate)).toLocaleString()]})}),Object(O.jsx)("li",{children:Object(O.jsxs)("small",{children:["last run id:"," ",Object(O.jsx)("a",{href:e,target:"_blank",className:"report-link",rel:"noreferrer",children:t.metadata.run_id})]})})]})}},{key:"renderTableData",value:function(t,e){var a=this;return this.sortTable(t,e).map((function(t,e){var s=t.statistic,r=t.metadata,n=s.total!==s.passed+s.skipped;return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:a.renderReportLink(t,r,n,s.total)}),Object(O.jsx)("td",{children:a.renderResults(s)}),Object(O.jsx)("td",{children:a.renderMetadataCell(t)})]},e)}))}},{key:"renderTableHeader",value:function(t,e,a){var s={name:"report id",statistic:"results",lastUpdate:"most recent"},r=a?"sort-by-asc":"sort-by-desc",n=Object.keys(s).map((function(n,c){return Object(O.jsxs)(h.a,{variant:"dark",onClick:function(){t(n,!a)},children:[s[n].toUpperCase(),Object(O.jsx)("span",{className:e===n?r:""})]},c)}));return Object(O.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(O.jsxs)("div",{children:[this.state.data.reportsCount," reports"]}),Object(O.jsx)("div",{children:n})]})}},{key:"render",value:function(){return Object(O.jsxs)(p.a,{hover:!0,responsive:"sm",size:"sm",variant:"dark",id:"reportsTable",children:[Object(O.jsx)("caption",{children:Object(O.jsxs)("small",{children:["docs size: ",this.state.data.docsSize]})}),Object(O.jsx)("thead",{children:Object(O.jsx)("tr",{children:Object(O.jsx)("td",{colSpan:"3",id:"sortButtons",children:this.renderTableHeader(this.updateSorting,this.state.sortBy,this.state.isSortAsc)})})}),Object(O.jsx)("tbody",{children:this.renderTableData(this.state.sortBy,this.state.isSortAsc)})]})}}]),a}(r.a.Component),x=a(342),k=a(343),y=a(341),g=a(336),S=a(340),A=a(173),N=a(174),C=a(74),T=a(69),D=a(178),w=function(t){Object(j.a)(a,t);var e=Object(u.a)(a);function a(t){var s;return Object(l.a)(this,a),(s=e.call(this,t)).state={data:{reports:[]},sortBy:"lastUpdate",isSortAsc:!1,stats:[],failedTests:[],statsChartData:[]},s}return Object(d.a)(a,[{key:"parseStats",value:function(){var t={};this.state.stats.forEach((function(e){var a=new Date(e.time.start).toISOString().split("T")[0];t[a]?(t[a].failed+=e.statistic.failed+e.statistic.broken,t[a].skipped+=e.statistic.skipped,t[a].passed+=e.statistic.passed,t[a].unknown+=e.statistic.unknown,t[a].total+=e.statistic.total):(t[a]=Object.assign({},e.statistic),t[a].failed+=e.statistic.broken,t[a].date=a)})),this.setState({statsChartData:Object.values(t)})}},{key:"componentDidMount",value:function(){var t=this;fetch("./metrics.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){t.setState({stats:e.stats}),t.setState({failedTests:e.failedTests}),t.parseStats()})).catch(console.log),o.a.pageview("metrics")}},{key:"renderStatsSummary",value:function(){var t=this.state.stats.reduce((function(t,e){return t.failed+=e.statistic.failed+e.statistic.broken,t.testCases+=e.statistic.total,t.total++,t}),{failed:0,testCases:0,total:0});console.log(JSON.stringify(t));var e=t.failed/t.testCases*100;return Object(O.jsx)("div",{children:Object(O.jsxs)("p",{children:["Failures: ",e,"% Test case runs:"," ",t.testCases," Total runs: ",t.total]})})}},{key:"renderFailedTests",value:function(){return this.state.failedTests.map((function(t,e){return Object(O.jsxs)("div",{children:[t.fileName," ",t.name," ",t.error.statusMessage," ",t.error.statusTrace.substring(20)]},e)}))}},{key:"renderSummaryChart",value:function(){return Object(O.jsx)("div",{children:Object(O.jsxs)(g.a,{width:1200,height:300,data:this.state.statsChartData,margin:{top:5,right:60,bottom:5,left:60},children:[Object(O.jsx)(S.a,{stroke:"white"}),Object(O.jsx)(A.a,{dataKey:"date",stroke:"white"}),Object(O.jsx)(N.a,{stroke:"white"}),Object(O.jsx)(C.a,{}),Object(O.jsx)(T.a,{}),Object(O.jsx)(D.a,{type:"monotone",dataKey:"passed",stroke:"#8884d8",isAnimationActive:!1}),Object(O.jsx)(D.a,{type:"monotone",dataKey:"failed",stroke:"#82ca9d",isAnimationActive:!1})]})})}},{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("span",{children:"METRICS"}),this.renderStatsSummary(),this.renderSummaryChart()]})}}]),a}(r.a.Component);function _(t){var e=t.activeNavbar,a=t.setActiveNavbar;return Object(O.jsxs)(x.a,{variant:"dark",className:"App-nav",children:[Object(O.jsx)(x.a.Brand,{href:"#",children:"Jetpack E2E Dashboard"}),Object(O.jsx)(x.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(O.jsx)(x.a.Collapse,{id:"basic-navbar-nav",children:Object(O.jsxs)(k.a,{className:"me-auto",activeKey:e,children:[Object(O.jsx)(k.a.Link,{href:"#",eventKey:"0",onSelect:function(t){return a(parseInt(t))},children:"Recent reports"}),Object(O.jsx)(k.a.Link,{href:"#",eventKey:"1",onSelect:function(t){return a(parseInt(t))},children:"Metrics"})]})})]})}function B(t){var e=t.activeNavbar;return console.log("QQQQQQ",e),Object(O.jsx)("div",{className:"App-content",children:0===e?Object(O.jsx)(m,{}):Object(O.jsx)(w,{})})}function U(t){var e=t.activeNavbar,a=t.setActiveNavbar;return Object(O.jsxs)("div",{children:[Object(O.jsx)("header",{className:"App-header",children:"\xa0"}),Object(O.jsx)(_,{activeNavbar:e,setActiveNavbar:a})]})}o.a.initialize("UA-208890082-1");var M=function(){var t=Object(s.useState)(0),e=Object(i.a)(t,2),a=e[0],r=e[1];return Object(O.jsxs)(y.a,{fluid:!0,className:"App",children:[Object(O.jsx)(U,{activeNavbar:a,setActiveNavbar:r}),Object(O.jsx)(B,{activeNavbar:a}),Object(O.jsx)("footer",{className:"App-footer",children:Object(O.jsxs)("div",{children:[Object(O.jsx)("a",{target:"_blank",href:"https://github.com/Automattic/jetpack-e2e-reports/",rel:"noreferrer",children:"Code"})," \u2022 ",Object(O.jsx)("a",{target:"_blank",href:"https://github.com/Automattic/jetpack-e2e-reports/actions",rel:"noreferrer",children:"Actions"})]})})]})};c.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(M,{})}),document.getElementById("root"))}},[[330,1,2]]]);
//# sourceMappingURL=main.133ae365.chunk.js.map