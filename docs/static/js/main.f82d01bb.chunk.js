(this["webpackJsonpjetpack-e2e-reports"]=this["webpackJsonpjetpack-e2e-reports"]||[]).push([[0],{187:function(t,e,a){},189:function(t,e,a){},329:function(t,e,a){"use strict";a.r(e);var s=a(0),r=a.n(s),n=a(38),c=a.n(n),i=(a(187),a(21)),o=(a(188),a(189),a(84)),l=a(85),d=a(86),j=a(92),u=a(332),b=a(333),h=a(334),p=a(118),f=a(70),v=a(3),O=function(t){Object(d.a)(a,t);var e=Object(j.a)(a);function a(t){var s;return Object(o.a)(this,a),(s=e.call(this,t)).updateSorting=function(t,e){return s.setState({sortBy:t,isSortAsc:e})},s.state={data:{reports:[]},sortBy:"lastUpdate",isSortAsc:!1},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var t=this;fetch("./summary.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){t.setState({data:e})})).catch(console.log)}},{key:"sortTable",value:function(t,e){switch(t){case"name":return this.sortAlphabetically(e);case"lastUpdate":return this.sortByDate(e);case"statistic":return this.sortByStatus(e)}}},{key:"sortByDate",value:function(t){return this.state.data.reports.sort((function(e,a){return t?Date.parse(e.lastUpdate)-Date.parse(a.lastUpdate):Date.parse(a.lastUpdate)-Date.parse(e.lastUpdate)}))}},{key:"sortAlphabetically",value:function(t){return this.state.data.reports.sort((function(e,a){return t?e.name-a.name:a.name-e.name}))}},{key:"sortByStatus",value:function(t){return this.state.data.reports.sort((function(e,a){return t?e.statistic.failed+e.statistic.broken-(a.statistic.failed+a.statistic.broken):a.statistic.failed+a.statistic.broken-(e.statistic.failed+e.statistic.broken)}))}},{key:"renderReportLink",value:function(t,e,a,s){var r="https://automattic.github.io/jetpack-e2e-reports/".concat(t.name,"/report/"),n=t.name,c=t.name;if(e.pr_title){var i;i="(#".concat(e.pr_number,")"),c="".concat(e.pr_title," ").concat(i)}var o="https://github.com/Automattic/jetpack/tree/".concat(e.branch),l="https://github.com/Automattic/jetpack/pull/".concat(e.pr_number),d=f.c,j="warning";return s>0&&(d=a?f.d:f.a,j=a?"failed":"passed"),Object(v.jsxs)("ul",{className:"list-unstyled",children:[Object(v.jsxs)("li",{children:[Object(v.jsx)(p.a,{className:j,icon:d}),"\xa0",Object(v.jsxs)("a",{href:r,className:"report-link",target:"_blank",rel:"noreferrer",children:[c,Object(v.jsx)("br",{})]})]}),Object(v.jsx)("li",{children:Object(v.jsxs)("small",{children:["#",n," "," \u2022 ",Object(v.jsx)(p.a,{icon:f.b})," ",Object(v.jsx)("a",{href:o,target:"_blank",className:"report-link",rel:"noreferrer",children:e.branch}),e.pr_number?" \u2022 ":"",e.pr_number&&Object(v.jsxs)("a",{href:l,target:"_blank",className:"report-link",rel:"noreferrer",children:["PR ",e.pr_number]})]})})]})}},{key:"renderResults",value:function(t){var e=["failed","passed","total"].map((function(e,a){var s="failed"===e?t[e]+t.broken:t[e];return Object(v.jsxs)(u.a,{className:"label label-status-".concat(e),children:[e," ",s]},a)}));return Object(v.jsx)("div",{children:e})}},{key:"renderMetadataCell",value:function(t){var e="https://github.com/Automattic/jetpack/actions/runs/".concat(t.metadata.run_id);return Object(v.jsxs)("ul",{className:"list-unstyled",children:[Object(v.jsx)("li",{children:Object(v.jsxs)("small",{children:["last update:"," ",new Date(Date.parse(t.lastUpdate)).toLocaleString()]})}),Object(v.jsx)("li",{children:Object(v.jsxs)("small",{children:["last run id:"," ",Object(v.jsx)("a",{href:e,target:"_blank",className:"report-link",rel:"noreferrer",children:t.metadata.run_id})]})})]})}},{key:"renderTableData",value:function(t,e){var a=this;return this.sortTable(t,e).map((function(t,e){var s=t.statistic,r=t.metadata,n=s.total!==s.passed+s.skipped;return Object(v.jsxs)("tr",{children:[Object(v.jsx)("td",{children:a.renderReportLink(t,r,n,s.total)}),Object(v.jsx)("td",{children:a.renderResults(s)}),Object(v.jsx)("td",{children:a.renderMetadataCell(t)})]},e)}))}},{key:"renderTableHeader",value:function(t,e,a){var s={name:"report id",statistic:"results",lastUpdate:"most recent"},r=a?"sort-by-asc":"sort-by-desc",n=Object.keys(s).map((function(n,c){return Object(v.jsxs)(b.a,{variant:"dark",onClick:function(){t(n,!a)},children:[s[n].toUpperCase(),Object(v.jsx)("span",{className:e===n?r:""})]},c)}));return Object(v.jsxs)("div",{className:"d-flex justify-content-between",children:[Object(v.jsxs)("div",{children:[this.state.data.reportsCount," reports"]}),Object(v.jsx)("div",{children:n})]})}},{key:"render",value:function(){return Object(v.jsxs)(h.a,{hover:!0,responsive:"sm",size:"sm",variant:"dark",id:"reportsTable",children:[Object(v.jsx)("caption",{children:Object(v.jsxs)("small",{children:["docs size: ",this.state.data.docsSize]})}),Object(v.jsx)("thead",{children:Object(v.jsx)("tr",{children:Object(v.jsx)("td",{colSpan:"3",id:"sortButtons",children:this.renderTableHeader(this.updateSorting,this.state.sortBy,this.state.isSortAsc)})})}),Object(v.jsx)("tbody",{children:this.renderTableData(this.state.sortBy,this.state.isSortAsc)})]})}}]),a}(r.a.Component),m=a(341),x=a(342),k=a(340),y=a(335),S=a(339),g=a(172),A=a(173),N=a(73),C=a(68),T=a(177),D=function(t){Object(d.a)(a,t);var e=Object(j.a)(a);function a(t){var s;return Object(o.a)(this,a),(s=e.call(this,t)).state={data:{reports:[]},sortBy:"lastUpdate",isSortAsc:!1,stats:[],failedTests:[],statsChartData:[]},s}return Object(l.a)(a,[{key:"parseStats",value:function(){var t={};this.state.stats.forEach((function(e){var a=new Date(e.time.start).toISOString().split("T")[0];t[a]?(t[a].failed+=e.statistic.failed+e.statistic.broken,t[a].skipped+=e.statistic.skipped,t[a].passed+=e.statistic.passed,t[a].unknown+=e.statistic.unknown,t[a].total+=e.statistic.total):(t[a]=Object.assign({},e.statistic),t[a].failed+=e.statistic.broken,t[a].date=a)})),this.setState({statsChartData:Object.values(t)})}},{key:"componentDidMount",value:function(){var t=this;fetch("./metrics.json",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){return t.json()})).then((function(e){t.setState({stats:e.stats}),t.setState({failedTests:e.failedTests}),t.parseStats()})).catch(console.log)}},{key:"renderStatsSummary",value:function(){var t=this.state.stats.reduce((function(t,e){return t.failed+=e.statistic.failed+e.statistic.broken,t.testCases+=e.statistic.total,t.total++,t}),{failed:0,testCases:0,total:0});console.log(JSON.stringify(t));var e=t.failed/t.testCases*100;return Object(v.jsx)("div",{children:Object(v.jsxs)("p",{children:["Failures: ",e,"% Test case runs:"," ",t.testCases," Total runs: ",t.total]})})}},{key:"renderFailedTests",value:function(){return this.state.failedTests.map((function(t,e){return Object(v.jsxs)("div",{children:[t.fileName," ",t.name," ",t.error.statusMessage," ",t.error.statusTrace.substring(20)]},e)}))}},{key:"renderSummaryChart",value:function(){return Object(v.jsx)("div",{children:Object(v.jsxs)(y.a,{width:1200,height:300,data:this.state.statsChartData,margin:{top:5,right:60,bottom:5,left:60},children:[Object(v.jsx)(S.a,{stroke:"white"}),Object(v.jsx)(g.a,{dataKey:"date",stroke:"white"}),Object(v.jsx)(A.a,{stroke:"white"}),Object(v.jsx)(N.a,{}),Object(v.jsx)(C.a,{}),Object(v.jsx)(T.a,{type:"monotone",dataKey:"passed",stroke:"#8884d8",isAnimationActive:!1}),Object(v.jsx)(T.a,{type:"monotone",dataKey:"failed",stroke:"#82ca9d",isAnimationActive:!1})]})})}},{key:"render",value:function(){return Object(v.jsxs)("div",{children:[Object(v.jsx)("span",{children:"METRICS"}),this.renderStatsSummary(),this.renderSummaryChart()]})}}]),a}(r.a.Component);function _(t){var e=t.activeNavbar,a=t.setActiveNavbar;return Object(v.jsxs)(m.a,{variant:"dark",className:"App-nav",children:[Object(v.jsx)(m.a.Brand,{href:"#",children:"Jetpack E2E Dashboard"}),Object(v.jsx)(m.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(v.jsx)(m.a.Collapse,{id:"basic-navbar-nav",children:Object(v.jsxs)(x.a,{className:"me-auto",activeKey:e,children:[Object(v.jsx)(x.a.Link,{href:"#",eventKey:"0",onSelect:function(t){return a(t)},children:"Recent reports"}),Object(v.jsx)(x.a.Link,{href:"#",eventKey:"1",onSelect:function(t){return a(t)},children:"Metrics"})]})})]})}function w(t){var e=t.activeNavbar;return console.log("QQQQQQ",e),Object(v.jsx)("div",{className:"App-content",children:"0"===e?Object(v.jsx)(O,{}):Object(v.jsx)(D,{})})}function B(t){var e=t.activeNavbar,a=t.setActiveNavbar;return Object(v.jsxs)("div",{children:[Object(v.jsx)("header",{className:"App-header",children:"\xa0"}),Object(v.jsx)(_,{activeNavbar:e,setActiveNavbar:a})]})}var U=function(){var t=Object(s.useState)(0),e=Object(i.a)(t,2),a=e[0],r=e[1];return Object(v.jsxs)(k.a,{fluid:!0,className:"App",children:[Object(v.jsx)(B,{activeNavbar:a,setActiveNavbar:r}),Object(v.jsx)(w,{activeNavbar:a}),Object(v.jsx)("footer",{className:"App-footer",children:Object(v.jsxs)("div",{children:[Object(v.jsx)("a",{target:"_blank",href:"https://github.com/Automattic/jetpack-e2e-reports/",rel:"noreferrer",children:"Code"})," \u2022 ",Object(v.jsx)("a",{target:"_blank",href:"https://github.com/Automattic/jetpack-e2e-reports/actions",rel:"noreferrer",children:"Actions"})]})})]})};c.a.render(Object(v.jsx)(r.a.StrictMode,{children:Object(v.jsx)(U,{})}),document.getElementById("root"))}},[[329,1,2]]]);
//# sourceMappingURL=main.f82d01bb.chunk.js.map